module Setup
  SOUNDFONT_REGEX = "/*.sf{2,3}"
  extend self
  attr_reader :shot_formats, :shot_format, :shot_dir
  attr_reader :shot_filename, :save_filename
  attr_reader :soundfont, :soundfonts
  attr_accessor :save_dir, :save_filename, :click_timer
  def clear
    @shot_formats = ["jpg", "png"]
    @shot_format = "jpg"
    @shot_dir = "Screenshots"
    @shot_filename = "screenshot"
    @save_dir = "Saves"
    @save_filename = "Save"
    @click_timer = 10
    @soundfont = System::SOUNDFONT || ""
  end

  def auto_create_dirs
    unless Dir.exist?(@shot_dir)
      Dir.mkdir(@shot_dir)
    end
    unless Dir.exist?(@save_dir)
      Dir.mkdir(@save_dir)
    end
  end

  def add_soundfonts(dir)
    names = Dir[dir + SOUNDFONT_REGEX].sort
    names.size.times {|n| @soundfonts << names[n] }
  end

  def find_soundfonts
    @soundfonts = []
    add_soundfonts(System::SOUNDFONT_DIR)
    add_soundfonts(Dir.pwd + "/Audio/SF2")
    if @soundfont.empty?
      if @soundfonts.size > 0
        @soundfont = @soundfonts[0]
      end
    else
      @soundfonts.delete(@soundfont)
      @soundfonts.unshift(@soundfont)
    end
  end

  def soundfont_index
    @soundfonts.index(@soundfont)
  end
  clear
  auto_create_dirs
  find_soundfonts
end